<h1 id="gulp-require-timer">Gulp Require Timer</h1>
<p>I built my first non-trivial gulpfile following tutorials on the web and examples from the different libraries I included. Worse, gulp was claiming super fast performance. This library gave me visibility into the other tasks being done in my gulpfile that were slowing gulp down.</p>
<h2 id="how-to-use">How to Use</h2>
<p>This is a very simple library that won't clutter your output or slow down the system significantly and is intended to be left installed even after the system is going fast enough. There are more robust gulp timers available, but they are bigger tools than I've ever needed for my projects.</p>
<p>The first line in your gulpfile should be importing this library:</p>
<pre><code>const requiret = require(&#39;gulp-require-timer&#39;)</code></pre>
<p>After that, you should never call require directly again and should always call requiret.require like this.</p>
<pre><code>const gulp = requiret.require(&#39;gulp&#39;)</code></pre>
<p>After all the requires that you want to report on have been executed, set requiret.notification to false.</p>
<pre><code>requiret.notifications = false</code></pre>
<p>Even after notifications have been set to false, the library stores execution times, which are available in requiret.times.</p>
<h2 id="advice-on-optimization">Advice on Optimization</h2>
<p>For the original draft of my first full gulpfile, most of the delay was require statements outside of gulp tasks.</p>
<p>Require caches each file, so these two blocks of code will have similar performance</p>
<pre><code>requiret.require(&#39;gulp&#39;)


//calling it 3 times only executes it once, so there&#39;s no performance penalty to this.
requiret.require(&#39;gulp&#39;)
requiret.require(&#39;gulp&#39;)
requiret.require(&#39;gulp&#39;)</code></pre>
<p>That means that instead of a structure like this.</p>
<pre><code>const l1 = requiret.require(&#39;library1&#39;)
const l2 = requiret.require(&#39;library2&#39;)
const l3 = requiret.require(&#39;library3&#39;)

gulp.task(&#39;task1&#39;, () =&gt; {
  l1.dosomething()
})

gulp.task(&#39;task2&#39;, () =&gt; {
  l2.dosomething()
})

gulp.task(&#39;task3&#39;, () =&gt; {
  l3.dosomething()
})</code></pre>
<p>It's much better to put the require statements inside of the tasks whenever possible.</p>
<pre><code>gulp.task(&#39;task1&#39;, () =&gt; {
  const l1 = requiret.require(&#39;library1&#39;)
  l1.dosomething()
})

gulp.task(&#39;task2&#39;, () =&gt; {
  const l2 = requiret.require(&#39;library2&#39;)
  l2.dosomething()
})

gulp.task(&#39;task3&#39;, () =&gt; {
  const l3 = requiret.require(&#39;library3&#39;)
  l3.dosomething()
})</code></pre>
<p>Because require optimizes multiple calls, there's no need to try to prevent require from being called repeatedly for one library. This structure means that you don't have to wait for libraries 2 and 3 to load in order to use library 1. As an added benefit, if you do end need to execute all three tasks, this structure allows gulp to run things in parallel, which isn't possible for blocks of require statements at the top of your gulpfile.</p>
<p>Putting numbers on it, if each require statement takes 1 second, and each dosomething statement takes 2 seconds, this structure change would take task 1 from 5 seconds (3 * 1 second for the require statements and 2 seconds for the dosomething statement) to 3 seconds (1 second for a single require statement and 2 seconds for the dosomething statement).</p>
<h2 id="repository">Repository</h2>
<p>The repository for this project is available at <a href="https://github.com/ze6ke/gulp-require-timer">https://github.com/ze6ke/gulp-require-timer</a>.</p>
<h2 id="license">License</h2>
<p>This library is available under the MIT license.</p>
